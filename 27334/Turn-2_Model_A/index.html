<!DOCTYPE html>
<html>
<head>
    <title>Health Data Export</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
    <button id="exportPDF">Export to PDF</button>
    <button id="exportCSV">Export to CSV</button>

    <script>
    // Assume this data structure for health records
    const healthData = {
        medications: [{name: 'Aspirin', dosage: '100mg', date: '2023-10-01'}, /* ... */],
        symptoms: [{severity: 5, date: '2023-10-01', notes: 'Headache'}, /* ... */],
        visits: [{doctor: 'Dr. Smith', date: '2023-09-25', summary: 'Routine checkup'}, /* ... */]
    };

    document.getElementById('exportPDF').addEventListener('click', function() {
        const doc = new jsPDF();
        let yPos = 10;

        // Function to add text to PDF
        const addText = (text, fontSize = 12) => {
            doc.setFontSize(fontSize);
            doc.text(text, 10, yPos);
            yPos += 10;
        };

        // Add data to PDF
        addText('Health Report', 18);
        for (let key in healthData) {
            addText(key.toUpperCase(), 14);
            healthData[key].forEach(item => {
                for (let prop in item) {
                    addText(`${prop}: ${item[prop]}`, 10);
                }
                yPos += 5; // Space between entries
            });
        }

        doc.save('health_report.pdf');
    });

    document.getElementById('exportCSV').addEventListener('click', function() {
        // Flatten the healthData for CSV
        const csvData = healthData.medications.map(med => ({
            ...med,
            type: 'Medication'
        })).concat(
            healthData.symptoms.map(sym => ({...sym, type: 'Symptom'})),
            healthData.visits.map(visit => ({...visit, type: 'Visit'}))
        );

        const csv = Papa.unparse(csvData);
        const blob = new Blob([csv], {type: "text/csv;charset=utf-8"});
        saveAs(blob, "health_report.csv");
    });
    </script>
</body>
</html>