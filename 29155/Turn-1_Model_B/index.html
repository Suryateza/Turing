<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Archery Game</title>
<style>
    body { margin: 0; background: #f0f0f0; }
    svg { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
    #trajectory { stroke: rgba(0,0,0,0.3); stroke-width: 2; fill: none; }
</style>
</head>
<body>
<svg id="gameCanvas" width="800" height="400" viewBox="0 0 800 400">
    <rect width="100%" height="100%" fill="#e6f3ff"/>
    <g id="bow" transform="translate(100, 200)">
        <path d="M0,0 C50,-50 50,50 0,0" stroke="brown" fill="none" stroke-width="5"/>
    </g>
    <g id="arrowGroup">
        <line id="arrow" x1="100" y1="200" x2="120" y2="200" stroke="black" stroke-width="2"/>
        <path d="M120,200 L110,195 L110,205 Z" fill="black"/>
    </g>
    <circle id="target" cx="700" cy="200" r="50" fill="red"/>
    <path id="trajectory" visibility="hidden"/>
</svg>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/gsap.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    const bow = document.getElementById('bow');
    const arrow = document.getElementById('arrow');
    const arrowGroup = document.getElementById('arrowGroup');
    const target = document.getElementById('target');
    const trajectory = document.getElementById('trajectory');
    let isDragging = false;
    let startX, startY;

    // Mouse events for drawing the bow
    document.addEventListener('mousedown', (e) => {
        if (e.target === arrow) {
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
        }
    });

    document.addEventListener('mousemove', (e) => {
        if (!isDragging) return;
        const dx = e.clientX - startX;
        const dy = e.clientY - startY;
        const angle = Math.atan2(dy, dx);
        const distance = Math.min(Math.hypot(dx, dy), 100); // Limit the draw distance
        
        gsap.to(bow, {rotation: angle * (180/Math.PI), transformOrigin:"0% 50%", duration:0.1});
        gsap.to(arrowGroup, {x: distance, rotation: angle * (180/Math.PI), transformOrigin:"0% 50%", duration:0.1});
    });

    document.addEventListener('mouseup', (e) => {
        if (isDragging) {
            isDragging = false;
            const endX = arrow.getAttribute('x2');
            const endY = arrow.getAttribute('y2');
            const startX = arrow.getAttribute('x1');
            const startY = arrow.getAttribute('y1');

            // Calculate trajectory
            const controlX = (parseInt(startX) + parseInt(endX)) / 2;
            const controlY = parseInt(startY) - 100; // Adjust for arc height
            
            trajectory.setAttribute('d', `M${startX},${startY} Q${controlX},${controlY} ${target.cx.baseVal.value},${target.cy.baseVal.value}`);
            trajectory.setAttribute('visibility', 'visible');

            // Animate arrow along path
            gsap.to(arrowGroup, {
                motionPath: {
                    path: trajectory,
                    align: trajectory,
                    alignOrigin: [0.5, 0.5],
                    autoRotate: true
                },
                duration: 1.5,
                ease: "power1.out",
                onComplete: () => {
                    trajectory.setAttribute('visibility', 'hidden');
                    gsap.set(arrowGroup, {x: 0, rotation: 0}); // Reset arrow for next shot
                }
            });
        }
    });
});
</script>
</body>
</html>
